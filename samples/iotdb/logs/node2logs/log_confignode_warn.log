2023-05-27 03:00:33,176 [main] WARN  o.a.i.c.s.StartupChecks:38 - iotdb.jmx.port missing from datanode-env.sh(Unix or OS X, if you use Windows, check conf/datanode-env.bat) 
2023-05-27 03:00:33,566 [main] WARN  o.a.i.d.c.IoTDBDescriptor:127 - Cannot find IOTDB_HOME or IOTDB_CONF environment variable when loading config file iotdb-common.properties, use default configuration 
2023-05-27 03:00:33,603 [main] WARN  o.a.i.d.c.IoTDBDescriptor:171 - Couldn't load the configuration iotdb-common.properties from any of the known sources. 
2023-05-27 03:00:33,604 [main] WARN  o.a.i.d.c.IoTDBDescriptor:127 - Cannot find IOTDB_HOME or IOTDB_CONF environment variable when loading config file iotdb-datanode.properties, use default configuration 
2023-05-27 03:00:33,605 [main] WARN  o.a.i.d.c.IoTDBDescriptor:199 - Couldn't load the configuration iotdb-datanode.properties from any of the known sources. 
2023-05-27 03:00:33,799 [main] WARN  o.a.i.c.c.ClientManager:63 - Borrow client from pool for node TEndPoint(ip:172.20.0.10, port:22277) failed, you need to increase dn_max_connection_for_internal_service. 
net.sf.cglib.core.CodeGenerationException: org.apache.thrift.transport.TTransportException-->java.net.ConnectException: Connection refused (Connection refused)
	at net.sf.cglib.core.ReflectUtils.newInstance(ReflectUtils.java:235)
	at net.sf.cglib.core.ReflectUtils.newInstance(ReflectUtils.java:220)
	at net.sf.cglib.proxy.Enhancer.createUsingReflection(Enhancer.java:639)
	at net.sf.cglib.proxy.Enhancer.firstInstance(Enhancer.java:538)
	at net.sf.cglib.core.AbstractClassGenerator.create(AbstractClassGenerator.java:225)
	at net.sf.cglib.proxy.Enhancer.createHelper(Enhancer.java:377)
	at net.sf.cglib.proxy.Enhancer.create(Enhancer.java:304)
	at org.apache.iotdb.commons.client.sync.SyncThriftClientWithErrorHandler.newErrorHandler(SyncThriftClientWithErrorHandler.java:48)
	at org.apache.iotdb.commons.client.sync.SyncConfigNodeIServiceClient$Factory.makeObject(SyncConfigNodeIServiceClient.java:115)
	at org.apache.iotdb.commons.client.sync.SyncConfigNodeIServiceClient$Factory.makeObject(SyncConfigNodeIServiceClient.java:94)
	at org.apache.commons.pool2.impl.GenericKeyedObjectPool.create(GenericKeyedObjectPool.java:780)
	at org.apache.commons.pool2.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:439)
	at org.apache.commons.pool2.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:350)
	at org.apache.iotdb.commons.client.ClientManager.borrowClient(ClientManager.java:50)
	at org.apache.iotdb.confignode.client.sync.SyncConfigNodeClientPool.sendSyncRequestToConfigNodeWithRetry(SyncConfigNodeClientPool.java:72)
	at org.apache.iotdb.confignode.service.ConfigNode.registerConfigNode(ConfigNode.java:251)
	at org.apache.iotdb.confignode.service.ConfigNode.active(ConfigNode.java:142)
	at org.apache.iotdb.confignode.service.ConfigNodeCommandLine.run(ConfigNodeCommandLine.java:80)
	at org.apache.iotdb.commons.ServerCommandLine.doMain(ServerCommandLine.java:58)
	at org.apache.iotdb.confignode.service.ConfigNode.main(ConfigNode.java:81)
Caused by: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused (Connection refused)
	at org.apache.thrift.transport.TSocket.open(TSocket.java:243)
	at org.apache.iotdb.rpc.TElasticFramedTransport.open(TElasticFramedTransport.java:91)
	at org.apache.iotdb.commons.client.sync.SyncConfigNodeIServiceClient.<init>(SyncConfigNodeIServiceClient.java:62)
	at org.apache.iotdb.commons.client.sync.SyncConfigNodeIServiceClient$$EnhancerByCGLIB$$3da544ed.<init>(<generated>)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
	at net.sf.cglib.core.ReflectUtils.newInstance(ReflectUtils.java:228)
	... 19 common frames omitted
Caused by: java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at org.apache.thrift.transport.TSocket.open(TSocket.java:238)
	... 27 common frames omitted
2023-05-27 03:00:33,800 [main] WARN  o.a.i.c.c.s.SyncConfigNodeClientPool:95 - REGISTER_CONFIG_NODE failed on ConfigNode TEndPoint(ip:172.20.0.10, port:22277), because Borrow client from pool for node TEndPoint(ip:172.20.0.10, port:22277) failed, you need to increase dn_max_connection_for_internal_service., retrying 0... 
2023-05-27 03:00:33,902 [main] WARN  o.a.i.c.c.ClientManager:63 - Borrow client from pool for node TEndPoint(ip:172.20.0.10, port:22277) failed, you need to increase dn_max_connection_for_internal_service. 
net.sf.cglib.core.CodeGenerationException: org.apache.thrift.transport.TTransportException-->java.net.ConnectException: Connection refused (Connection refused)
	at net.sf.cglib.core.ReflectUtils.newInstance(ReflectUtils.java:235)
	at net.sf.cglib.core.ReflectUtils.newInstance(ReflectUtils.java:220)
	at net.sf.cglib.proxy.Enhancer.createUsingReflection(Enhancer.java:639)
	at net.sf.cglib.proxy.Enhancer.firstInstance(Enhancer.java:538)
	at net.sf.cglib.core.AbstractClassGenerator.create(AbstractClassGenerator.java:231)
	at net.sf.cglib.proxy.Enhancer.createHelper(Enhancer.java:377)
	at net.sf.cglib.proxy.Enhancer.create(Enhancer.java:304)
	at org.apache.iotdb.commons.client.sync.SyncThriftClientWithErrorHandler.newErrorHandler(SyncThriftClientWithErrorHandler.java:48)
	at org.apache.iotdb.commons.client.sync.SyncConfigNodeIServiceClient$Factory.makeObject(SyncConfigNodeIServiceClient.java:115)
	at org.apache.iotdb.commons.client.sync.SyncConfigNodeIServiceClient$Factory.makeObject(SyncConfigNodeIServiceClient.java:94)
	at org.apache.commons.pool2.impl.GenericKeyedObjectPool.create(GenericKeyedObjectPool.java:780)
	at org.apache.commons.pool2.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:439)
	at org.apache.commons.pool2.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:350)
	at org.apache.iotdb.commons.client.ClientManager.borrowClient(ClientManager.java:50)
	at org.apache.iotdb.confignode.client.sync.SyncConfigNodeClientPool.sendSyncRequestToConfigNodeWithRetry(SyncConfigNodeClientPool.java:72)
	at org.apache.iotdb.confignode.service.ConfigNode.registerConfigNode(ConfigNode.java:251)
	at org.apache.iotdb.confignode.service.ConfigNode.active(ConfigNode.java:142)
	at org.apache.iotdb.confignode.service.ConfigNodeCommandLine.run(ConfigNodeCommandLine.java:80)
	at org.apache.iotdb.commons.ServerCommandLine.doMain(ServerCommandLine.java:58)
	at org.apache.iotdb.confignode.service.ConfigNode.main(ConfigNode.java:81)
Caused by: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused (Connection refused)
	at org.apache.thrift.transport.TSocket.open(TSocket.java:243)
	at org.apache.iotdb.rpc.TElasticFramedTransport.open(TElasticFramedTransport.java:91)
	at org.apache.iotdb.commons.client.sync.SyncConfigNodeIServiceClient.<init>(SyncConfigNodeIServiceClient.java:62)
	at org.apache.iotdb.commons.client.sync.SyncConfigNodeIServiceClient$$EnhancerByCGLIB$$3da544ed.<init>(<generated>)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
	at net.sf.cglib.core.ReflectUtils.newInstance(ReflectUtils.java:228)
	... 19 common frames omitted
Caused by: java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at org.apache.thrift.transport.TSocket.open(TSocket.java:238)
	... 27 common frames omitted
2023-05-27 03:00:33,903 [main] WARN  o.a.i.c.c.s.SyncConfigNodeClientPool:95 - REGISTER_CONFIG_NODE failed on ConfigNode TEndPoint(ip:172.20.0.10, port:22277), because Borrow client from pool for node TEndPoint(ip:172.20.0.10, port:22277) failed, you need to increase dn_max_connection_for_internal_service., retrying 1... 
